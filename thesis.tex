\documentclass[pdftex,14pt,a4paper]{extreport}
\usepackage[utf8]{inputenc} %koi8-r + cyrillic encoding
\usepackage[bulgarian]{babel}

\usepackage[pdftex]{graphicx}
\usepackage{hyperref}
\hypersetup{
 	colorlinks = true%,
  %linkcolor = blue
}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

\begin{document}
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\begin{titlepage}
	\begin{center}
		{\Huge ТЕХНОЛОГИЧНО УЧИЛИЩЕ ЕЛЕКТРОННИ СИСТЕМИ\\[0.5cm]} {\Large към ТЕХНИЧЕСКИ УНИВЕРСИТЕТ - СОФИЯ\\[3cm]}
		{\Huge ДИПЛОМНА РАБОТА\\[3cm]}
		Тема: ''Мултитенант'' система за управление на интернет сайтове\\[3cm]
		\begin{minipage}{0.4\textwidth}
			\begin{flushleft} \large
				\emph{Дипломант:}\\
				Михаил \textsc{Здравков}
			\end{flushleft}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\begin{flushright} \large
				\emph{Научен ръководител:} \\
				Инж.~Кирил \textsc{Митов}
			\end{flushright}
		\end{minipage}

		\vfill

		% Bottom of the page
		{\large София 2014}

	\end{center}
\end{titlepage}
\tableofcontents
\listoftables
\listoffigures
\pagebreak
\addcontentsline{toc}{part}{Увод}
\chapter*{Увод}
Some увод
\chapter {Преглед на подобни продукти. Обзор на софтуерни технологии.}
\section {Преглед на подобни продукти}
Някои приложения и решения доближаващи се по функционалност до разработваната дипломна работа (макар и само в някои аспекти):
\subsection {Heroku}
Heroku\footnote{Източник на информацията за Heroku са \url{https://www.heroku.com} и \\\url{https://devcenter.heroku.com/articles/quickstart}} е платформа за хостване на Интернет приложения на облачно базиран сървър\footnote{облачно базиран сървър е мрежа от компютри, която предоставя изчислителни ресурси на клиента.}, която може да бъде използвана за приложения, написани на редица програмни езици (някои от които са Ruby, Clojure, Python, Java и Scala). Целта на Heroku е да позволи на клиентите си да се фокусират над правенето на приложения, а не на инфраструктура. Управлението на приложенията се извършва чрез командния ред, а изпращането на програмния код чрез Git (популярна система за управление на версиите). Heroku позволява лесен разтеж на приложението - това става чрез система, която дава възможност да скалирате ресурсите, до които приложението ви има достъп. Heroku са въвели модел на стандартна, изчислителна, работна единица, която те наричат Dyno. Всяка една такава единица е лек (взима малко ресурси), изолиран контейнер, в който работи клиентското приложение. Всяко Dyno се равнянва на 512 мегабайта оперативна памет и приоритет 1 в поделянето на процесорно време. С други думи, ако приложението на клиента изведнъж получи извънредно много заявки от клиенти, потребителя на Heroku може да увеличи броя Dyno-та, които използва и да получи повече ресурси от сървърите на Heroku, а когато количеството посещения на приложението му се нормализира, да намали броя Dyno-та, така че да не заплаща ресурси, които не използва.\\\\
Съществуват някои съществени разлики в поставените цели при Heroku и при разработваната дипломна работа, които водят до множество разлики при реализацията и при начина на употреба на двете системи. Heroku е създадена за да работи с различни приложения. Иначе казано, всеки клиент на системата може да качи своето приложение и то няма нищо общо с всички останали. Дипломната работа е създадена да работи с едно единствено приложение, което случи като шаблон за създаването на останалите. Разликата е, че Heroku е създадена за да помогне на програмиста да инсталира някъде своето приложение, докато дипломната работа дава възможност на всякакви потребители да получат свое копие на шаблонното приложение.
\section {Обзор на софтуерни технологии}
\subsection {HTTP сървъри}
В тази секция ще разгледаме някои от популярните възможни приложения за предоставяне на съдържание в Интернет.
\subsubsection {Apache}
Apache\footnote{Източници на информацията за Apache HTTP Server са \url{http://news.netcraft.com/archives/category/web-server-survey} и \url{http://www.ntchosting.com/apache-web-server.html}} HTTP Server или само Apache е уеб сървър с отворен код, който има ключова роля за първоначалното разрастване на WWW (World Wide Web). Чрез него работят над 70\% от сайтовете. Счита се от много специалисти за платформа, според която се разработват и оценяват другите уеб сървъри.
Приложението стартира на много операционни системи, включително Unix, GNU, FreeBSD, Linux, Solaris, Mac OS X, Microsoft Windows, OS/2, Novell NetWare и други платформи.
Apache се разработва от отворено общество от разработчици - Apache Software Foundation. Сървърът има възможности за промяна на съобщенията за грешки, удостоверяване на потребителите, договаряне на съдържанието (изключително полезно при многоезични сайтове), proxy модул, както и поддръжка на CGI и SSI. Има множество модули за Apache, които позволяват работа на разнообразни скриптове и осигуряване на динамично съдържание, криптиране, ограничаване и други.
\subsubsection {nginx}
nginx\footnote{Източници на информацията за nginx са \url{http://nginx.com/} и \url{https://nginx.org}} е високопроизводителен уеб сървър и прокси под BSD лиценз. Подобно на други приложения от този вид, архитектурата на nginx е модулна - при компилиране на софтуера се определя кои модули да бъдат вградени в него. Съществуват и над 20 потребителски модула.
nginx може да се използва като обратен прокси сървър, който прехвърля всички или само определени заявки към други физически сървъри. Крайните сървъри могат се избират от nginx на ротационен принцип, но решенията кой от тях да се използва могат да се взимат и чрез по-сложни алгоритми, благодарение на допълнителни модули. Често срещана употреба на приложението е за обработване на заявки за статично съдържание и прехвърляне на по-сложните заявки за динамично съдържание към по-сложен уеб сървър, например Apache. Въпреки това, nginx има пълна FastCGI поддръжка и може да изпълнява скриптове на всеки език за програмиране, който поддържа този стандарт. Софтуерът може да се използва и като SMTP, POP3 и IMAP прокси сървър.
При определени ситуации, особено при обслужване на заявки за статично съдържание, nginx е по-бърз и заема по-малко ресурси от конкурентния софтуер - Apache и lighttpd.
\subsection {Технологии за създавне на Интернет приложения}
\subsubsection {MVC}
Модел-Изглед-Контролер (Model-View-Controller или MVC) е архитектурен шаблон за дизайн (design pattern) в програмирането, основан на разделянето на бизнес логиката от графичния интерфейс и данните в дадено приложение.
\begin{itemize}
  \item Model е частта от програмния код, която представя данните от реалния свят, върху които работим и които сме моделирали. Често моделът служи за свързване с база данни. Основната бизнес логика свързана с обработката на данните се извършва в моделите.
  \item View е частта от програмния код, която описва как ще изглежда уеб страницата, която потребителя ще види. В нея се избягва да има програмна логика и данните, които тя показва се взимат от моделите посредством контролерите.
  \item Controller е частта от програмния код, която служи за връзка между моделите и изгледите. Тя се занимава с това да взима нужната информация от модела и да я предоставя на изгледа. В нея се извършват също дейности като уторизация на потребителите, обработка на параметри от HTTP заявки и пренасочване към други страници.
\end{itemize}
MVC носи значителни предимства при разработването на уеб приложения. Модулярността позволява да направите различен интерфейс за същите модели, като промените единствено изгледа и евентуално контролера. Друга полза е това, че различни разработчици могат да се занимават единствено с областите, които са в тяхната специалност. Например уеб дизайнера да работи само върху изгледите (без да има нужда да познава моделите и контролерите), а пък друг разработчик да работи единствено върху моделите и контролерите, без да има нужда да знае как информацията ще бъде представена в изгледите.
\subsubsection {Multitenancy}
Multitenancy\footnote{Източник на информацията за Multitenancy е \url{http://msdn.microsoft.com/en-us/library/aa479086.aspx}}(буквално преведено - Множествено наемателство) е принцип в софтуерната архитектура, където една инстанция на компютърната програма обслужва множество клиенти и се грижи за виртуалното разделяне на данните между ''наемателите'' (потребителите). Принципа контрастира с multi-instance (много инстанции), където за всеки клиент има отделна инстанция на приложението. Смята се, че Multitenancy принципа е важна част от технологията на облачните изчисления. Преимуществата на Multitenancy са по-малкото нужни ресурси (тъй като всяка инстанция на приложението би взимала някакво количество ресурси, докато при Multitenancy инстанцията е само една) и по-лесната комуникация между ''наемателите'' (защото комуникацията се извършва вътре в самото приложение, а не между приложенията). Някои от недостатъците са по-трудната разработка и по-трудното разрастване на програмата при множество потребители. Multitenancy може да се раздели на три вида\footnote{Подходите са изброени по степен на изолация -- първи е метода, който предоставя най-висока степен на изолация, а последен е този, който предлага най-ниска.}:

\begin{table}[h!]
  \begin{tabular}{|p{2.7cm}|p{5cm}|p{5cm}|}
    \hline
    Подход & Предимства & Недостатъци \\
    \hline
    Отделни бази данни &
    \parbox[t]{5cm}{
      По-висока степен на сигурност \\\\
      По-лесна скалируемост на програмата \\\\
      Лесно възобновяване на базата данни на единичен наемател от резервно копие
    } &
    \parbox[t]{5cm}{
      По-бавно изпълнение на програмата (извършва се често свързане към базата данни) \\\\
      Повече необходими ресурси (много копия на базата данни)
    }
    \\
    \hline
    Обща база и отделни схеми &
    \parbox[t]{5cm}{
      По-бързо изпълнение на програмата \\\\
      По-малко необходими ресурси
    }
    &
    \parbox[t]{5cm}{
      По-трудна скалируемост \\\\
      По-трудно възобновяване на данните
    }
    \\
    \hline
    Обща схема &
    \parbox[t]{5cm}{
     По-бързо изпълнение на програмата \\\\
     По-малко необходими ресурси
    }
    &
    \parbox[t]{5cm}{
      По-трудно гарантиране на сигурността \\\\
      По-малка възможност за скалиране на програмата \\\\
      По-трудно възобновяване на данните
    }
    \\
    \hline
  \end{tabular}
  \caption {Подходи при Multitenancy архитектура}
\end{table}
\subsubsection {HTML}
HTML, съкращение от HyperText Markup Language — на български ''език за маркиране на хипертекст'', е основният маркиращ език за описание и дизайн на уеб страници. HTML е стандарт в Интернет, а правилата се определят от международния консорциум W3C. Описанието на документа става чрез специални елементи, наречени HTML елементи или маркери, които се състоят от етикети или тагове (HTML tags) и ъглови скоби (като например елемента <html>). HTML елементите са основната градивна единица на уеб страниците. Чрез тях се оформят отделните части от текста на една уеб страница, като заглавия, цитати, раздели, хипертекстови препратки и т.н. Най-често HTML елементите са групирани по двойки <h1> и </h1>.
В повечето случаи HTML кодът е написан в текстови файлове и се хоства на сървъри, свързани към Интернет. Тези файлове съдържат текстово съдържание с маркери - инструкции за браузъра за това как да се показва текстът. Предназначението на уеб браузърите е да могат да прочетат HTML документите и да ги превърнат в уеб страници. Браузърите не показват HTML таговете, а ги използват, за да интерпретират съдържанието на страницата.
\subsubsection {CSS}
CSS (Cascading Style Sheets) е език за описание на стилове - използва се основно за описване на представянето на документ, написан на език за маркиране. Най-често се използва заедно с HTML, но може да се приложи върху произволен XML документ. Официално спецификацията на CSS се поддържа от W3C (World Wide Web Consortium). Създаден първоначално като средство за разделяне на съдържанието от представянето му, днес той се използва основно за визуално оформление на HTML страници.
CSS позволява да се определя как да изглеждат елементите на една HTML страница - шрифтове, размери, цветове, фонове, и др. CSS кодът се състои от последователност от стилови правила, всяко от които представлява селектор, последван от свойства и стойности. Например в следния CSS код:
p {font-size: 9pt;} има едно правило. То се състои от селектора p и свойството font-size, на което е зададена стойност 9pt. Това правило ще направи размера на шрифта във всички параграфи 9 точки.
\subsubsection {JavaScript}
JavaScript е интерпретиран език за програмиране, разпространяван с повечето Уеб браузъри. Поддържа обектно-ориентиран и функционален стил на програмиране. Създаден е в Netscape през 1995-та. Най-често се прилага към HTML-а на Интернет страница с цел добавяне на функционалност и зареждане на данни. JavaScript е програмен език, който позволява динамична промяна на поведението на браузъра в рамките на дадена HTML страницата. JavaScript се зарежда, интерпретира и изпълнява от уеб браузъра, който му осигурява достъп до Обектния модел на браузъра. JavaScript функции могат да се свържат със събития на страницата (например: движение/натискане на мишката, клавиатурата или елемент от страницата, и други потребителски действия). Javascript е сред най-широко разпространените езици за програмиране в Интернет. Прието е JavaScript програмите да се наричат скриптове.
\subsubsection {PHP}
PHP е скриптов език, работещ върху сървърната (обслужваща) страна език с отворен код, който е проектиран за уеб програмиране и е широко използван за създаване на сървърни приложения и динамично уеб-съдържание. PHP е обектно ориентиран език със синтаксис подобен на езиците С и Perl.
\subsubsection {Ruby on Rails}
Ruby on Rails (често съкращавано като Rails или RoR) е популярна платформа за разработване на уеб-приложения, написана изцяло на програмния език Ruby, включваща в себе си множество реализирани шаблони за програмиране, сред които Model-View-Controller, ORM (Object Relational Mapping) и много други. Ruby on Rails има за цел да улесни и ускори начина на разработване на уеб-приложенията. Самата софтуерна рамка е с отворен код. Съществен елемент от философията на платформата е "Конвенция пред конфигурация" (Convention over configuration). Това означава, че Ruby on Rails се стреми да предостави възможно най-готова конфигурация за най-честия случай. Много неща, които в други платформи ще трябва да бъдат направени от програмиста, в Rails са направени по подразбиране.
\subsection {Технологии за изолиране на програми}
\subsubsection {Виртуални машини}
Виртуална машина е софтуерно базирана емулация на компютър. Виртуалните машини се делят на два основни вида:
\begin{itemize}
  \item Системна виртуална машина предоставя цяла системна платформа, която да позволява изпълняването на цяла операционна система. Тези виртуални машини обикновено симулират съществуваща компютърна архитектура и са създадени за да позволят неща като:
  \begin{itemize}
    \item Пускане на програми на хардуер, който не е достъпен за използване. (например за изпълнение на програми върху остаряла и излязла от употреба компютърна архитектура)
    \item Създаването на множество инстанции на виртуалната машина, което води до по-ефективно използване на компютърните ресурси. (например във фирми или учебни заведения, където множество служители или ученици използват отделна операционна система, без да е нужно за всеки един да има отделен хардуер. По този начин може да се направи оптимизация на използваните ресурси, като виртуалните машини се разпределят на по-малко или повече реални компютри в зависимост от натовареността.)
  \end{itemize}
\item Процес-вирутална машина е създадена за да съдържа една единствена програма, което значи, че поддържа един единствен процес. Такива виртуални машини са обикновено свързани с определен програмен език или няколко такива и имат функцията да предоставят портативност на програмите между различните компютърни архитектури.
\end{itemize}
Важна характеристика на виртуалните машини е, че софтуера работещ във виртуалната машина е ограничен от ресурсите и ограниченията, които виртуалната машина налага и, че не може да напусне виртуалната среда, в която се намира. Виртуалните машини имат важно значение за технологията на изчисления в облак и имат широка употреба в множество сфери. Въпреки това, съществен недостатък при тази технология е значителното количество ресурси, което виртуалната машина заема.
\subsubsection {chroot}
chroot в Unix операционните системи е операция, която променя root директорията на даден процес и неговите наследници. Процес, работещ в такава модифицирана среда, не може да именова (и следователно, обикновено да достъпва) файлове извън своето файлово дърво. Модифицираната среда се нарича chroot jail (chroot затвор). chroot механизъма не е създаден за да предотвратява атаки от привилегировани потребители. На повечето системи привилегирован потребител може да направи втори chroot за да ''пробие'' изолираната среда, в която се намира. chroot разделя единствено файловата система на изолираната среда, от тази на операционната система, докато други системни ресурси остават споделени. При chroot, модифицираната среда може да вижда процесите, мрежовите интерфейси и друга информация за операционната система, в която се намира. За това възниква нуждата от друг, по-сигурен начин да се отделят части от операционната система и да се постигне частична виртуализация на ниво операционна система.
\subsubsection {FreeBSD jail}
FreeBSD jail-овете са инструмент съществуващ в операционната система FreeBSD, който възниква поради нуждата от сигурна виртуална среда, която да е разделена от операционната система, в която се намира. Докато chroot отделя единствено файловата система на модифицираната среда от тази на операционната система, FreeBSD jail-овете отнемат множество възможности на изолираната среда. Някои от тях са:
\begin{itemize}
  \item Отнемане на възможността на изолираната среда да вижда процесите, които работят на операционната система. Jail-а си има свои собствени процеси.
  \item Отнемане на възможността на изолираната среда да вижда потребителите от операционната система. Jail-а си има свои собствени потребители.
  \item Изолираната среда не може да добавя и премахва kernel модули.
  \item Изолираната среда си има собствени мрежови интерфейси, както и собствен IP адрес и hostname.
  \item Както и при chroot изолираната среда има свое собствено дърво на файловата система.
\end{itemize}
Съществен недостатък е, че всеки jail има собствено копие на операционната система.
\subsubsection {ezjail}
ezjail е програма, която може да бъде инсталирана на FreeBSD системата, която оптимизира и прави по-лесно създаването на FreeBSD jail-ове. Начина по който тя работи е да направи един главен базов jail, които е копие на операционната система и всеки следващ jail вместо да копира цялата операционна система, просто му се mount-ва базовия jail, в режим на Read Only (само четене без писане). ezjail прави лесно и ограничаването на системните ресурси (като оперативна памет, приоритет при използването на процесорно време и др.) на jail-а.
\subsubsection {Docker}
Docker е инструмент създаден за операционните системи от Linux семейството, който автоматизира инсталирането на програми в стандартни контейнери, които могат после лесно да бъдат пренасяни. Docker разширява LXC (LinuX Containers), които на свой ред са базирани на cgroups (в превод контролни групи - функционалност добавена към Linux ядрото във версия 2.6.24 през 2006) и някои други функции на Linux ядрото, като например namespace-ове (именовани пространства). Docker може да бъде представен добре, чрез алегорията за стандартния търговски контейнер за пренасяне на стоки. Преди създаването му, стоката се е пренасяла трудно, тъй като някой предмети били чупливи, различните стоки имали различна форма, разтовapването/натоварването на кораби и други превозни средства било проблем. След създаването на стандартния транспортен контейнер (метална кутия с определени размери), много от тези проблеми били решени, тъй като имало един унифициран предмет, който трябвало да бъде пренесен - транспортната кутия, а това какво има вътре нямало значение за кораба, крана и тн. Подобен е и проблема в софтуерната индустрия. След създаването на една програма от разработчика, тя често трябва да бъде пренесена на някакъв сървър или на друга машина. Това често е сложен проблем, защото програмата има много други софтуерни компоненти, на които разчита за да работи и не се знае дали там, където ще бъде пренесена, тези компоненти ще бъдат налични и то с правилната версия. Затова Docker помага този проблем да бъде решен, като предоставя един стандартен контейнер, който е напълно изолиран от средата, в която се намира (не споделя процеси, потребители, файлова система и тн.) За програмиста това значи, че може да пакетира своята програма, заедно с всичките й нужни компоненти и тя ще работи независимо къде бъде сложен контейнера. Docker контейнерите се пускат бързо и лесно, за разлика от виртуалните машини. Обикновено контейнера бива създаден и пуснат в рамките на милисекунди. Контейнерите се правят чрез специално Docker ''изображение'' (файл с разширение .img), който съдържа базова операционна система и евентуално програмата, която искаме да изпълняваме в контейнерите, заедно с нужните й софтуерни компоненти и други програми, които са нужни за работата й. Изображението го има само веднъж и след това се създават контейнери, чийто процеси имат достъп до файловата система на изображението (за процесите в контейнерите изглежда сякаш работят на истинска операционна система - тази, която има на изображението). Когато един контейнер се опита да пише по файловата система, той не променя изображението, от което е създаден, ами чрез файловата система AUFS се създава нов ''слой'' на файловата система, който съдържа само промените, които контейнера е направил. По този начин общото за всички контейнери го има само веднъж, а промените, които те правят по файловата система, са частни за тях и другите контейнери не разбират за тях. \\\\
Пример: Имаме специално Docker изображение, съдържащо операционната система Ubuntu. Нека изображението ни се казва ubuntu. С Docker, можем да използваме командата ''docker run -i -t ubuntu bash'' и тя ще създаде нов контейнер, в който работи програмата bash (опциите -i -t са за да държат stdin (стандартния вход) отворен и да се създаде псевдо tty). В терминалния ни емулатор сега работи не shell-a на операционната ни система, ами този на контейнера. Тоест на едно Ubuntu. Ако сега например извикаме ''ps -e'', което е стандартната програма за показване на работещите процеси в системата, ще получим единствено bash и ps (която току що сме пуснали). Това показва, че в контейнера работят единствено процесите, които ние сме пуснали, и също, че процесите на контейнера са отделени от тези на съдържащата го операционна система.
\\\\
Можем също така, например, да изтрием цялата операционна система на контейнера с ''rm -rf /'' и след това, макар, че този контейнер, разбира се, ще бъде неизползваем, това няма да навреди нито на съдържащата го операционна система, нито на други контейнери направени от същото изображение.
\chapter {Функционални изисквания. Аргументация на избора на развойните средства. Описание на сценария на реализацията на продукта}
\section {Функционални изисквания}
\subsection {Автоматична инсталация на уеб приложение по образец, при поискване от потребител.}
\subsection {Конфигуриране на инсталираните уеб приложения.}
\subsection {Управление на приставките на инсталираните уеб приложения.}
\section {История на разработката на дипломната работа}
\subsection {Подход 1 - Multitenancy и Ruby on Rails}
\subsection {Подход 2 - Разделяне на клиентското приложение от дипломната работа и Ruby on Rails}
\subsection {Подход 3 - FreeBSD Jail-ове}
\subsection {Подход 4 - Docker}
%\bibliography{thesis}
%\bibliographystyle{plain}
\end{document}
